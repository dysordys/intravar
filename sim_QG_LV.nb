(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    103301,       2240]
NotebookOptionsPosition[    102327,       2202]
NotebookOutlinePosition[    102664,       2217]
CellTagsIndexPosition[    102621,       2214]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
This Mathematica notebook simulates a single instance of the quantitative \
genetic Lotka-Volterra model. The results can be plotted, and a movie can be \
made from the dynamics.\
\>", "Subchapter",
 CellChangeTimes->{{3.666531537722056*^9, 3.666531663405964*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Clear", " ", "all", " ", "variables", " ", "and", " ", "functions"}], " ",
    "*)"}]}]], "Input",
 CellChangeTimes->{{3.637322032445478*^9, 3.637322036827528*^9}, {
  3.6373242932574787`*^9, 3.637324293543751*^9}, {3.6383648674069*^9, 
  3.638364867680562*^9}, {3.638532509031641*^9, 3.638532509215373*^9}, {
  3.638533324407572*^9, 3.6385333247596607`*^9}, {3.6394129161307592`*^9, 
  3.639412916328513*^9}, {3.642358036420536*^9, 3.6423580371031523`*^9}, {
  3.6459748347874107`*^9, 3.6459748350644913`*^9}, {3.647026559735401*^9, 
  3.647026560092215*^9}, {3.653406427270583*^9, 3.653406427461027*^9}, {
  3.657201290652562*^9, 3.657201290809084*^9}, {3.657375696634927*^9, 
  3.6573756974599457`*^9}, {3.665250407775477*^9, 3.665250408032344*^9}, {
  3.666531575876008*^9, 3.6665315866523733`*^9}}],

Cell[CellGroupData[{

Cell["Define parameters", "Section",
 CellChangeTimes->{{3.64235860340806*^9, 3.642358605351142*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"S", "=", "2"}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"Number", " ", "of", " ", "species"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"\[Omega]", "=", "0.1"}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"Width", " ", "of", " ", "competition", " ", "kernel"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"bshape", "=", "2"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Shape", " ", "of", " ", "intrinsic", " ", "fitness", " ", "function"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]", "=", "0.5"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Effective", " ", "half"}], "-", 
    RowBox[{"width", " ", "of", " ", "trait", " ", "axis"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hsquare", "=", "0.1"}], ";"}], " ", 
  RowBox[{"(*", " ", "Heritability", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Sigma]", "[", "1", "]"}], "=", "0.05"}], ",", 
     RowBox[{
      RowBox[{"\[Sigma]", "[", "2", "]"}], "=", "0.1"}]}], "}"}], ";"}], " ", 
  
  RowBox[{"(*", " ", 
   RowBox[{"Intraspecific", " ", "standard", " ", "deviations"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ninit", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Initial", " ", "species", " ", "abundances"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"\[Mu]init", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.4"}], ",", "0.3"}], "}"}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Initial", " ", "species", " ", "mean", " ", "traits"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"c", "=", "0"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Asymmetry", " ", "parameter"}], ";", " ", 
    RowBox[{
    "leave", " ", "it", " ", "at", " ", "0", " ", "for", " ", "unperturbed", 
     " ", "case"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"extinctionthreshold", "=", "0.001"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Extinction", " ", 
    RowBox[{"threshold", ":", " ", 
     RowBox[{
     "species", " ", "below", " ", "this", " ", "density", " ", "will", " ", 
      "be", " ", "considered", " ", 
      RowBox[{"extinct", "."}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"alleethreshold", "=", 
   RowBox[{"10.0", "^", 
    RowBox[{"(", 
     RowBox[{"-", "20"}], ")"}]}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Threshold", " ", "density", " ", "at", " ", "which", " ", "weak", " ", 
    "Allee", " ", "effect", " ", "kicks", " ", "in"}], " ", 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.637323906055581*^9, 3.6373239069971848`*^9}, {
   3.637323999383214*^9, 3.6373241234613867`*^9}, {3.637324155429853*^9, 
   3.637324282251281*^9}, {3.63732465636528*^9, 3.637324675731101*^9}, {
   3.6373250820796957`*^9, 3.637325084891239*^9}, {3.6373251908219852`*^9, 
   3.637325306088502*^9}, {3.6373258334498167`*^9, 3.637325848793543*^9}, 
   3.6373258992101097`*^9, {3.637326025445652*^9, 3.6373260275075293`*^9}, {
   3.637326122468053*^9, 3.6373261225075083`*^9}, {3.6373263529451838`*^9, 
   3.637326380316525*^9}, {3.6373265436105633`*^9, 3.637326543825912*^9}, {
   3.637326606212639*^9, 3.6373266680816936`*^9}, 3.637326725365484*^9, {
   3.637326829719483*^9, 3.6373268298608418`*^9}, {3.63732707292525*^9, 
   3.637327072991509*^9}, {3.637327124014235*^9, 3.6373271240638657`*^9}, {
   3.6373274488043957`*^9, 3.637327475884759*^9}, {3.63732788247045*^9, 
   3.637327882527525*^9}, {3.637333635406342*^9, 3.637333635584737*^9}, {
   3.6373381313020782`*^9, 3.637338165528141*^9}, {3.6373386351436768`*^9, 
   3.637338655921454*^9}, {3.6373395637031107`*^9, 3.637339567758863*^9}, 
   3.63734253314994*^9, {3.637342564255197*^9, 3.637342683968967*^9}, {
   3.6373438033400297`*^9, 3.637343803397814*^9}, {3.6373454362013407`*^9, 
   3.6373454511662817`*^9}, {3.6373458545460052`*^9, 3.637345865153141*^9}, {
   3.6373460206271763`*^9, 3.6373460207236423`*^9}, {3.637346114298715*^9, 
   3.637346114427808*^9}, {3.6373464930777407`*^9, 3.637346493148085*^9}, 
   3.637346922102119*^9, 3.637347359092807*^9, {3.637347575156708*^9, 
   3.637347575376601*^9}, {3.637347615317676*^9, 3.637347616236657*^9}, {
   3.637348993770691*^9, 3.637349043150106*^9}, {3.637407331433824*^9, 
   3.637407331456484*^9}, {3.637407494333578*^9, 3.637407494573915*^9}, {
   3.6374075327818413`*^9, 3.637407532839367*^9}, {3.637407672941969*^9, 
   3.637407703440935*^9}, 3.63740790413592*^9, 3.637409098013845*^9, 
   3.637409190571331*^9, {3.637409421942649*^9, 3.63740942200233*^9}, 
   3.63740949999189*^9, {3.637409592634089*^9, 3.637409594114645*^9}, {
   3.6374097415112057`*^9, 3.637409741718253*^9}, {3.6374098657139683`*^9, 
   3.637409883474079*^9}, {3.6374103902118683`*^9, 3.637410444798923*^9}, {
   3.637410487626586*^9, 3.637410507451079*^9}, {3.637410571962682*^9, 
   3.637410572008903*^9}, {3.6374106129660997`*^9, 3.637410653305173*^9}, {
   3.637410684787056*^9, 3.637410735607061*^9}, {3.637415439478067*^9, 
   3.637415478565694*^9}, 3.637415525189521*^9, {3.637415582466798*^9, 
   3.637415607789262*^9}, {3.63741598198514*^9, 3.6374160105917397`*^9}, {
   3.6374161318871737`*^9, 3.6374161337391148`*^9}, {3.637416164177808*^9, 
   3.637416167304785*^9}, 3.637424829536097*^9, {3.6374248830274363`*^9, 
   3.6374249155261374`*^9}, {3.6374249722631083`*^9, 
   3.6374249738637533`*^9}, {3.6374250115022*^9, 3.637425014165875*^9}, 
   3.637425067374452*^9, {3.6374251117949457`*^9, 3.6374251142610397`*^9}, {
   3.637434614130199*^9, 3.6374346462079563`*^9}, {3.637434705234571*^9, 
   3.6374347052826138`*^9}, {3.637434757851767*^9, 3.637434764226708*^9}, {
   3.63743522489544*^9, 3.637435245822134*^9}, {3.637435281223735*^9, 
   3.637435331682431*^9}, {3.637435387146265*^9, 3.637435387266706*^9}, {
   3.637435953363758*^9, 3.637435959690752*^9}, {3.637435990711948*^9, 
   3.6374360006998863`*^9}, {3.63743632924397*^9, 3.637436336770651*^9}, {
   3.637436374680633*^9, 3.637436451606439*^9}, {3.637436655377561*^9, 
   3.6374366665604067`*^9}, {3.637436722062868*^9, 3.637436838627943*^9}, {
   3.6374370230625467`*^9, 3.6374370238473597`*^9}, {3.637437100219316*^9, 
   3.637437108472042*^9}, {3.637493667221655*^9, 3.6374936708222313`*^9}, {
   3.637493982953842*^9, 3.6374939837612886`*^9}, {3.63749419194795*^9, 
   3.637494191998658*^9}, {3.637494233158271*^9, 3.637494249137557*^9}, {
   3.6374943325378103`*^9, 3.6374943628380413`*^9}, {3.637494393666587*^9, 
   3.637494393681093*^9}, {3.63749449563174*^9, 3.6374944962247066`*^9}, {
   3.6374946399249277`*^9, 3.6374946545514603`*^9}, {3.637494859701985*^9, 
   3.637494868229827*^9}, {3.6374981048110943`*^9, 3.637498131541048*^9}, {
   3.6375192320344954`*^9, 3.6375193279280453`*^9}, {3.637519362714039*^9, 
   3.637519362797782*^9}, {3.637519417916285*^9, 3.637519417984071*^9}, 
   3.6375194485515127`*^9, {3.637583870825931*^9, 3.637583875448186*^9}, {
   3.637584007352427*^9, 3.637584024030242*^9}, {3.637584140263015*^9, 
   3.6375841433376493`*^9}, {3.6375970566663227`*^9, 
   3.6375970567211313`*^9}, {3.637597097815282*^9, 3.637597113267077*^9}, {
   3.6375972513295813`*^9, 3.6375972912070837`*^9}, {3.637597446824109*^9, 
   3.6375975120469112`*^9}, {3.637597608512631*^9, 3.637597610274499*^9}, {
   3.637597999638496*^9, 3.637597999698633*^9}, {3.6375991636671247`*^9, 
   3.637599261822106*^9}, {3.637600521066596*^9, 3.6376005215111628`*^9}, {
   3.637600744256585*^9, 3.6376007553168097`*^9}, 3.63760079147396*^9, {
   3.637600835982256*^9, 3.637600836222459*^9}, {3.6376010079060717`*^9, 
   3.6376010117848682`*^9}, {3.637601085296183*^9, 3.637601089470673*^9}, {
   3.6376011777915993`*^9, 3.63760120960323*^9}, {3.6376015236322823`*^9, 
   3.637601536311891*^9}, {3.637601577637669*^9, 3.6376015798875427`*^9}, 
   3.637601641799447*^9, {3.637601725121057*^9, 3.6376017282397947`*^9}, 
   3.637601827794971*^9, {3.6376024572662992`*^9, 3.637602500574218*^9}, {
   3.637602573655258*^9, 3.637602598816752*^9}, {3.6376026338468027`*^9, 
   3.6376026366810207`*^9}, {3.637602681821498*^9, 3.637602707401373*^9}, {
   3.637602827945928*^9, 3.637602871001251*^9}, {3.637602912810763*^9, 
   3.637602920873973*^9}, {3.637602987716037*^9, 3.637603002497604*^9}, {
   3.637603215950582*^9, 3.637603252366889*^9}, {3.637603405803944*^9, 
   3.637603405930488*^9}, {3.637603531882564*^9, 3.637603542356455*^9}, {
   3.637605648368976*^9, 3.63760571633867*^9}, {3.637605771198394*^9, 
   3.6376057758174467`*^9}, {3.6376058111221657`*^9, 3.637605823100203*^9}, {
   3.6376064048944387`*^9, 3.637606408326384*^9}, {3.637606452749897*^9, 
   3.6376064603100243`*^9}, {3.637606515896676*^9, 3.637606519638255*^9}, {
   3.637606580647134*^9, 3.637606581646905*^9}, {3.637607637599104*^9, 
   3.637607640435411*^9}, {3.637607699600855*^9, 3.6376077023944893`*^9}, {
   3.637607746577568*^9, 3.637607747165612*^9}, {3.6377908573357286`*^9, 
   3.6377909603771267`*^9}, {3.6377909968147373`*^9, 3.637791008402213*^9}, {
   3.637791070649514*^9, 3.637791158391266*^9}, {3.637791200354865*^9, 
   3.637791207375949*^9}, {3.6377913417864532`*^9, 3.637791375717906*^9}, {
   3.637791521849167*^9, 3.637791543985587*^9}, {3.6377916311127462`*^9, 
   3.637791668474082*^9}, {3.637791701919332*^9, 3.6377917231587267`*^9}, {
   3.637791764512148*^9, 3.637791862228148*^9}, {3.637791895443688*^9, 
   3.637792028404265*^9}, {3.637921886875002*^9, 3.6379219548605022`*^9}, {
   3.637922055593925*^9, 3.637922108706856*^9}, {3.637922148582035*^9, 
   3.637922163709278*^9}, {3.637922249995422*^9, 3.637922250123817*^9}, {
   3.637922299182032*^9, 3.637922320121777*^9}, {3.637922354658469*^9, 
   3.63792238087038*^9}, {3.6379225120470133`*^9, 3.637922641609519*^9}, {
   3.637922690359171*^9, 3.637922836780622*^9}, {3.6379230754978247`*^9, 
   3.637923081808382*^9}, {3.637923450954458*^9, 3.637923451422333*^9}, {
   3.637923481686983*^9, 3.6379234872417307`*^9}, {3.6379237912751617`*^9, 
   3.63792384703006*^9}, {3.6379239126789722`*^9, 3.637923912886754*^9}, {
   3.637924162255375*^9, 3.63792418734625*^9}, {3.6379247558633966`*^9, 
   3.637924756394526*^9}, {3.637924879138015*^9, 3.6379248795504704`*^9}, {
   3.637925569067246*^9, 3.637925581504634*^9}, {3.6379256561226997`*^9, 
   3.637925656266303*^9}, {3.637925691843614*^9, 3.637925692025484*^9}, {
   3.637925929216301*^9, 3.637926029279552*^9}, {3.6379260653247833`*^9, 
   3.63792606803548*^9}, {3.637926133482608*^9, 3.637926133795977*^9}, {
   3.637926247774279*^9, 3.637926319062332*^9}, {3.637926382991959*^9, 
   3.637926383268816*^9}, {3.637926430375128*^9, 3.6379264875422564`*^9}, {
   3.6379265426787558`*^9, 3.637926565748972*^9}, {3.6379267087917337`*^9, 
   3.637926708985455*^9}, {3.6379267446906424`*^9, 3.637926744795785*^9}, {
   3.637926809917058*^9, 3.6379268100312433`*^9}, {3.6379288148109093`*^9, 
   3.6379288222036877`*^9}, {3.637928901241593*^9, 3.637928949674711*^9}, {
   3.637929050132306*^9, 3.6379290502384233`*^9}, {3.637929114751781*^9, 
   3.6379291244223146`*^9}, {3.6379291590897913`*^9, 
   3.6379291938626757`*^9}, {3.637929985637608*^9, 3.63792998813877*^9}, {
   3.637930141430283*^9, 3.6379301431990023`*^9}, {3.6379331825348*^9, 
   3.637933182589285*^9}, {3.637933224271427*^9, 3.637933239736546*^9}, {
   3.637933297854197*^9, 3.637933297928589*^9}, {3.637933333074827*^9, 
   3.637933334452057*^9}, {3.637933374245302*^9, 3.6379333743471107`*^9}, {
   3.6379348642044153`*^9, 3.637934864249907*^9}, {3.6379401920589647`*^9, 
   3.637940192141734*^9}, {3.6379403375230913`*^9, 3.63794033759634*^9}, {
   3.637940506555279*^9, 3.637940506740992*^9}, {3.637940904175118*^9, 
   3.637940933598629*^9}, {3.637941234679309*^9, 3.637941234775022*^9}, {
   3.637941841195986*^9, 3.6379418420108633`*^9}, {3.637941886350124*^9, 
   3.6379418897736053`*^9}, {3.637941923779004*^9, 3.637942035274723*^9}, {
   3.637942088742352*^9, 3.637942092223345*^9}, {3.6379426686268663`*^9, 
   3.637942696274214*^9}, {3.637942923555986*^9, 3.6379429343697023`*^9}, {
   3.637943021480028*^9, 3.637943022531377*^9}, {3.637943114357884*^9, 
   3.63794312011049*^9}, {3.637943212772897*^9, 3.6379432391976547`*^9}, {
   3.637943322990294*^9, 3.637943323075344*^9}, {3.637943367704681*^9, 
   3.637943367840478*^9}, {3.637943415730082*^9, 3.637943466503332*^9}, {
   3.6379435366757917`*^9, 3.6379435492874527`*^9}, {3.6379437627430696`*^9, 
   3.637943837740946*^9}, {3.637944098754054*^9, 3.637944109650585*^9}, {
   3.63794418694245*^9, 3.6379442098636417`*^9}, {3.6379589414027967`*^9, 
   3.637959178877905*^9}, {3.63801930400299*^9, 3.6380193262122602`*^9}, {
   3.638019428491515*^9, 3.6380194287005777`*^9}, {3.638030273803698*^9, 
   3.6380302830675297`*^9}, {3.638031636271735*^9, 3.6380317597242517`*^9}, 
   3.63803182165773*^9, {3.638031963182974*^9, 3.6380319635464277`*^9}, {
   3.638032323800128*^9, 3.6380323399137287`*^9}, {3.638032796754457*^9, 
   3.638032796811038*^9}, {3.638033643234438*^9, 3.638033647098386*^9}, {
   3.638033759419753*^9, 3.63803375960011*^9}, {3.638033805293663*^9, 
   3.638033805625352*^9}, {3.6380341182933073`*^9, 3.6380341357608643`*^9}, {
   3.638034282630949*^9, 3.638034282713497*^9}, {3.6380344169346*^9, 
   3.63803441930997*^9}, {3.638056651566983*^9, 3.638056651953435*^9}, {
   3.6380567118234043`*^9, 3.638056711891816*^9}, {3.6380993701756573`*^9, 
   3.638099467488538*^9}, {3.638101400142997*^9, 3.638101414325549*^9}, {
   3.63810177538827*^9, 3.638101788079268*^9}, {3.6381018299577827`*^9, 
   3.6381018303603163`*^9}, {3.638102435754623*^9, 3.638102438045867*^9}, {
   3.6381025249861526`*^9, 3.638102532059536*^9}, {3.638102613377679*^9, 
   3.638102613568591*^9}, {3.638102896055628*^9, 3.638102918943692*^9}, {
   3.638102958381318*^9, 3.638102966004038*^9}, {3.638103031712606*^9, 
   3.638103047223345*^9}, {3.638103269905366*^9, 3.638103270568515*^9}, {
   3.63810448139916*^9, 3.6381044815208473`*^9}, {3.638105013881518*^9, 
   3.6381050139658318`*^9}, {3.638105054873653*^9, 3.638105059073758*^9}, {
   3.63810513098853*^9, 3.6381051748270884`*^9}, {3.638105312737569*^9, 
   3.638105322099885*^9}, {3.638105486952003*^9, 3.638105487158422*^9}, {
   3.638105518320182*^9, 3.6381055183548326`*^9}, {3.638105628537578*^9, 
   3.638105651033298*^9}, {3.638111932022522*^9, 3.638111961526692*^9}, 
   3.638112033736128*^9, {3.638112336705029*^9, 3.6381123370236273`*^9}, {
   3.638112483645105*^9, 3.638112509625901*^9}, {3.638112607693276*^9, 
   3.638112607967648*^9}, {3.6381995066107607`*^9, 3.638199516269198*^9}, {
   3.638199707199748*^9, 3.638199792339575*^9}, {3.6381998799902678`*^9, 
   3.638199880116393*^9}, {3.638199914978506*^9, 3.6381999882656183`*^9}, {
   3.6382000213571663`*^9, 3.638200087056262*^9}, {3.6382028474277897`*^9, 
   3.638202891870338*^9}, {3.638202977846723*^9, 3.638202978098991*^9}, {
   3.63820303010563*^9, 3.6382030301292963`*^9}, {3.638203111433742*^9, 
   3.638203152605165*^9}, {3.638203839123115*^9, 3.6382038430319138`*^9}, {
   3.638205011211116*^9, 3.638205011288268*^9}, {3.638209372337071*^9, 
   3.638209401855874*^9}, {3.638209562429359*^9, 3.638209709721245*^9}, {
   3.638274019496421*^9, 3.63827402871567*^9}, {3.638274083609967*^9, 
   3.6382740839780283`*^9}, {3.638274133444561*^9, 3.638274133706822*^9}, {
   3.638274243974236*^9, 3.638274301832436*^9}, {3.6382743501212177`*^9, 
   3.6382744164385567`*^9}, {3.638275458258923*^9, 3.638275461445537*^9}, {
   3.6382756652945137`*^9, 3.6382756654265823`*^9}, {3.6382774206025143`*^9, 
   3.638277420857448*^9}, {3.6382775256362953`*^9, 3.638277526005548*^9}, {
   3.638277707232119*^9, 3.638277707288663*^9}, {3.638277758132592*^9, 
   3.638277783342836*^9}, {3.638277814417675*^9, 3.6382778280883493`*^9}, {
   3.638277882603056*^9, 3.638277882876361*^9}, {3.638277919064485*^9, 
   3.6382779407819347`*^9}, 3.638278054885634*^9, {3.638278240889655*^9, 
   3.63827824217197*^9}, 3.638278272257803*^9, {3.6382853677739143`*^9, 
   3.638285399690834*^9}, 3.638285514207137*^9, {3.638285563265503*^9, 
   3.638285563551197*^9}, {3.638285760824193*^9, 3.63828576301655*^9}, {
   3.638285912982288*^9, 3.6382859416028633`*^9}, {3.638285977403673*^9, 
   3.638285988743142*^9}, 3.638286392326603*^9, {3.638286447072227*^9, 
   3.638286457347769*^9}, {3.6382865260117702`*^9, 3.6382865643800507`*^9}, {
   3.6382870233225813`*^9, 3.638287036037204*^9}, {3.638287240952755*^9, 
   3.6382872414082727`*^9}, {3.638287289152892*^9, 3.638287289981902*^9}, {
   3.6382874777566032`*^9, 3.638287486145833*^9}, {3.6382875640321627`*^9, 
   3.638287565655608*^9}, {3.638287713799533*^9, 3.63828772330262*^9}, {
   3.6383660463716087`*^9, 3.638366078525539*^9}, {3.638366111970969*^9, 
   3.638366112904819*^9}, {3.638367040759643*^9, 3.63836704099564*^9}, {
   3.6383670873812304`*^9, 3.638367087775338*^9}, {3.638367242126135*^9, 
   3.638367242925589*^9}, {3.638367500774358*^9, 3.638367528109301*^9}, {
   3.638367558539526*^9, 3.63836756396308*^9}, {3.638367681055359*^9, 
   3.638367681132971*^9}, {3.638367739190337*^9, 3.638367827659762*^9}, {
   3.6383972655785637`*^9, 3.63839726573223*^9}, {3.6383973476877613`*^9, 
   3.6383973477928743`*^9}, {3.6383974734990892`*^9, 3.638397481135495*^9}, {
   3.638397606395254*^9, 3.63839760731559*^9}, {3.638397720194149*^9, 
   3.63839772046478*^9}, {3.638397796472189*^9, 3.638397796524542*^9}, {
   3.6383978812464046`*^9, 3.6383978814643784`*^9}, {3.638397993724799*^9, 
   3.638398020585668*^9}, {3.638398103574711*^9, 3.638398103655957*^9}, {
   3.63839813743314*^9, 3.638398153666362*^9}, {3.6383983633838787`*^9, 
   3.638398422465392*^9}, {3.638398497240314*^9, 3.638398499900011*^9}, {
   3.638398552210623*^9, 3.638398570033655*^9}, {3.638532561655347*^9, 
   3.6385325617760363`*^9}, {3.638532983887035*^9, 3.638532984927305*^9}, {
   3.6385332323304033`*^9, 3.638533233153509*^9}, {3.6385343953624907`*^9, 
   3.6385344058027697`*^9}, {3.638534534129569*^9, 3.638534690316371*^9}, {
   3.6385347788409557`*^9, 3.6385347867272797`*^9}, {3.6385348714123697`*^9, 
   3.638534872353663*^9}, {3.638534912550179*^9, 3.63853491353174*^9}, {
   3.6385352408159847`*^9, 3.6385352648527308`*^9}, {3.638535960230736*^9, 
   3.6385359916298037`*^9}, {3.638536086768046*^9, 3.638536118022052*^9}, {
   3.6385361680236*^9, 3.63853616809163*^9}, 3.638538182128735*^9, {
   3.638538271210775*^9, 3.638538271499494*^9}, {3.6385390396626577`*^9, 
   3.638539039827161*^9}, 3.6385392520984287`*^9, {3.6385393067569933`*^9, 
   3.638539306948625*^9}, {3.638539340487608*^9, 3.638539365848493*^9}, {
   3.638546369938863*^9, 3.638546376896723*^9}, {3.638546481100771*^9, 
   3.6385464811825523`*^9}, {3.6385465195574303`*^9, 3.638546540621052*^9}, {
   3.638548424690008*^9, 3.638548424790173*^9}, {3.638548675409285*^9, 
   3.6385486778113194`*^9}, {3.63854874274758*^9, 3.6385487441457577`*^9}, {
   3.638549857516398*^9, 3.638549857635536*^9}, {3.638549958190222*^9, 
   3.638549958335751*^9}, {3.638551270140708*^9, 3.638551270320745*^9}, {
   3.638552061573798*^9, 3.638552100053794*^9}, {3.638552146535627*^9, 
   3.638552146785301*^9}, {3.638552252465836*^9, 3.638552252540509*^9}, {
   3.638552366429947*^9, 3.638552376956636*^9}, {3.638552508877253*^9, 
   3.638552508967688*^9}, {3.6385528339565372`*^9, 3.638552856513927*^9}, {
   3.638552945912756*^9, 3.6385529461678133`*^9}, {3.638553087000824*^9, 
   3.638553087100827*^9}, {3.638553634310142*^9, 3.638553635813142*^9}, {
   3.638553808686015*^9, 3.638553843278699*^9}, {3.638553959018697*^9, 
   3.638553967220155*^9}, {3.638611842329739*^9, 3.638611842754554*^9}, {
   3.6386118845641203`*^9, 3.638611884827475*^9}, {3.6386247312805567`*^9, 
   3.638624836768318*^9}, {3.638624924463909*^9, 3.63862492773818*^9}, {
   3.63862499149793*^9, 3.6386249984867487`*^9}, {3.638625524706019*^9, 
   3.638625545150094*^9}, {3.638639328279882*^9, 3.638639328577256*^9}, {
   3.638639427160982*^9, 3.638639485888158*^9}, {3.6386395943889914`*^9, 
   3.6386396116434193`*^9}, {3.639068432906582*^9, 3.639068498003413*^9}, {
   3.6390815238804007`*^9, 3.6390815241586237`*^9}, {3.639081567340516*^9, 
   3.639081588336006*^9}, {3.639081623706705*^9, 3.639081642691073*^9}, {
   3.639081813736978*^9, 3.639081813853978*^9}, {3.639081854026763*^9, 
   3.63908185413708*^9}, {3.639081891091502*^9, 3.6390818928144827`*^9}, {
   3.640001001750854*^9, 3.6400010018119793`*^9}, {3.640001398809689*^9, 
   3.6400013988992453`*^9}, {3.640426742382926*^9, 3.640426742611973*^9}, {
   3.640426795155561*^9, 3.640426795492395*^9}, {3.640972519890709*^9, 
   3.640972520657415*^9}, {3.640976139266201*^9, 3.640976139987727*^9}, 
   3.64097644611994*^9, {3.640977034700265*^9, 3.640977034756303*^9}, {
   3.640977070644167*^9, 3.6409773405898743`*^9}, {3.640977378105872*^9, 
   3.640977466460835*^9}, {3.640977503658128*^9, 3.640977581583247*^9}, {
   3.640977705951996*^9, 3.640977712051573*^9}, {3.640977746041244*^9, 
   3.640977799319376*^9}, {3.641044392512186*^9, 3.641044402094944*^9}, {
   3.6419221119458933`*^9, 3.641922112183074*^9}, {3.6419221446239977`*^9, 
   3.6419221499680147`*^9}, {3.641922189680958*^9, 3.641922235449548*^9}, {
   3.64192227182691*^9, 3.641922288122913*^9}, {3.641922326252035*^9, 
   3.6419223902130632`*^9}, {3.64192242308716*^9, 3.6419224707981358`*^9}, {
   3.641922503351529*^9, 3.6419225326897306`*^9}, {3.641922597281589*^9, 
   3.641922597585002*^9}, {3.6419226474425507`*^9, 3.64192264767416*^9}, {
   3.641922720085156*^9, 3.6419227224204893`*^9}, {3.641922778758369*^9, 
   3.6419227815976152`*^9}, {3.641922830814588*^9, 3.641922832854167*^9}, {
   3.641922870135681*^9, 3.6419228712876177`*^9}, {3.6419229797855473`*^9, 
   3.641922980025116*^9}, {3.641923045907174*^9, 3.641923069186726*^9}, {
   3.641923195997897*^9, 3.641923198597527*^9}, {3.641923250126828*^9, 
   3.641923250190344*^9}, {3.641923304025666*^9, 3.641923304064242*^9}, 
   3.641923430418652*^9, {3.641923500876956*^9, 3.64192350094844*^9}, {
   3.6421772404037724`*^9, 3.642177323813819*^9}, {3.6421773720574617`*^9, 
   3.642177453539198*^9}, {3.642177521681766*^9, 3.642177540727459*^9}, {
   3.642177582588399*^9, 3.642177586977412*^9}, {3.642178054863921*^9, 
   3.6421780688110647`*^9}, {3.642178142345245*^9, 3.642178147010839*^9}, {
   3.642178208064569*^9, 3.642178215426922*^9}, {3.642358047392261*^9, 
   3.6423580821041727`*^9}, {3.642358114237397*^9, 3.642358224913746*^9}, {
   3.64235826651331*^9, 3.642358292488559*^9}, {3.642358660464724*^9, 
   3.642358732211548*^9}, {3.642358767617495*^9, 3.6423590755104847`*^9}, {
   3.642359123622438*^9, 3.642359143407686*^9}, {3.64243206961269*^9, 
   3.642432074998642*^9}, 3.642765530908876*^9, {3.642765653661931*^9, 
   3.642765656995181*^9}, {3.643127066651965*^9, 3.643127173628474*^9}, {
   3.6431272064878817`*^9, 3.643127259073286*^9}, {3.6431273040912113`*^9, 
   3.643127306953333*^9}, {3.6431274045591097`*^9, 3.643127407642886*^9}, {
   3.643127715424384*^9, 3.643127715816627*^9}, {3.643127759958088*^9, 
   3.643127760367427*^9}, {3.6433856926398087`*^9, 3.6433857109352922`*^9}, 
   3.645101046632819*^9, {3.645101079541151*^9, 3.6451010907742434`*^9}, {
   3.645101126624958*^9, 3.645101127504352*^9}, {3.6451011652151613`*^9, 
   3.6451012435602694`*^9}, {3.645974234571888*^9, 3.645974412938127*^9}, {
   3.645974534352577*^9, 3.645974614788389*^9}, {3.645974652851576*^9, 
   3.64597468947602*^9}, {3.645974729208707*^9, 3.6459747300122967`*^9}, {
   3.6459747735987186`*^9, 3.645974775967868*^9}, {3.6459748123605824`*^9, 
   3.645974822591234*^9}, {3.647026567907674*^9, 3.6470267716077337`*^9}, {
   3.647026811784917*^9, 3.647026813033955*^9}, {3.647026950252573*^9, 
   3.647026999676949*^9}, {3.647109668738291*^9, 3.6471096726790323`*^9}, {
   3.647109906379006*^9, 3.6471099213176126`*^9}, {3.647110049670692*^9, 
   3.64711006779935*^9}, {3.647167254425167*^9, 3.647167276348175*^9}, {
   3.647255699328187*^9, 3.647255726644815*^9}, {3.6472557605959682`*^9, 
   3.647255776540786*^9}, {3.6472565206532907`*^9, 3.647256526233164*^9}, {
   3.647256662448279*^9, 3.647256708001225*^9}, {3.647346557658746*^9, 
   3.647346566115307*^9}, {3.647692414436058*^9, 3.64769243463043*^9}, {
   3.6532421197192173`*^9, 3.653242201553773*^9}, {3.653242272785324*^9, 
   3.653242273273926*^9}, {3.65324231019418*^9, 3.653242335269362*^9}, {
   3.653242444380764*^9, 3.653242453847519*^9}, {3.6532428038174953`*^9, 
   3.653242810373872*^9}, {3.653242929600192*^9, 3.653242929662318*^9}, {
   3.65324303471662*^9, 3.653243160572784*^9}, {3.653243196440152*^9, 
   3.653243206052126*^9}, {3.653243330705192*^9, 3.65324333223866*^9}, {
   3.653301052542224*^9, 3.6533011090369873`*^9}, {3.653301208802719*^9, 
   3.653301319689662*^9}, {3.65330137721299*^9, 3.6533013777719707`*^9}, {
   3.653301410141367*^9, 3.653301729616386*^9}, {3.6533061724731607`*^9, 
   3.6533062213618517`*^9}, {3.6533063351861067`*^9, 3.653306509300482*^9}, {
   3.653311631966735*^9, 3.653311633467943*^9}, {3.653316338507403*^9, 
   3.6533164885823174`*^9}, {3.65331705725049*^9, 3.6533171269062853`*^9}, {
   3.6533171956625147`*^9, 3.653317227597948*^9}, {3.653317583038548*^9, 
   3.653317583972519*^9}, {3.653317649647999*^9, 3.653317649748551*^9}, {
   3.6533186000816708`*^9, 3.653318771029479*^9}, {3.65331892637752*^9, 
   3.653318926518014*^9}, {3.653405172941366*^9, 3.6534051733391943`*^9}, {
   3.653405618565604*^9, 3.6534056270769777`*^9}, {3.653405668167589*^9, 
   3.653405668245631*^9}, {3.653405804691223*^9, 3.653405833377026*^9}, {
   3.65340588327669*^9, 3.653405884042091*^9}, {3.653405984502988*^9, 
   3.653406145103266*^9}, {3.654518914833681*^9, 3.654518915720541*^9}, {
   3.6545208030995207`*^9, 3.6545208605548897`*^9}, {3.6545209308860807`*^9, 
   3.654520948243857*^9}, {3.654521047976737*^9, 3.6545210692792673`*^9}, {
   3.65452112232196*^9, 3.654521122655486*^9}, {3.655755194724586*^9, 
   3.655755247324939*^9}, {3.65575528996673*^9, 3.655755291412578*^9}, {
   3.655755329909336*^9, 3.655755329973114*^9}, {3.655755616107629*^9, 
   3.655755672515812*^9}, {3.655755707990672*^9, 3.6557557080448103`*^9}, {
   3.655755763672276*^9, 3.655755784782153*^9}, {3.657200072416317*^9, 
   3.657200073569159*^9}, {3.657201022255227*^9, 3.657201023666459*^9}, 
   3.657201118074176*^9, {3.65720116889391*^9, 3.6572011697577753`*^9}, {
   3.6572012306778927`*^9, 3.6572012309852343`*^9}, {3.6572018356095667`*^9, 
   3.657201835922875*^9}, {3.657201941779063*^9, 3.6572019570475607`*^9}, {
   3.6573263395206327`*^9, 3.657326363857086*^9}, {3.65732642181056*^9, 
   3.657326425634179*^9}, {3.657375701869852*^9, 3.657375715875658*^9}, {
   3.6573770570786953`*^9, 3.657377105087933*^9}, {3.657631990215852*^9, 
   3.657632075267915*^9}, {3.6576321092186537`*^9, 3.6576321129488153`*^9}, {
   3.657632219893179*^9, 3.657632221948015*^9}, {3.657632308894751*^9, 
   3.657632310756009*^9}, {3.65763241044298*^9, 3.6576324481533117`*^9}, {
   3.657632552848991*^9, 3.65763262322254*^9}, {3.6576326579976*^9, 
   3.657632700328822*^9}, {3.657632757684988*^9, 3.657632792181724*^9}, {
   3.657632848472783*^9, 3.657632993745557*^9}, {3.657633204055963*^9, 
   3.657633322496023*^9}, {3.657633363267015*^9, 3.65763336528915*^9}, {
   3.6576333987000713`*^9, 3.657633412122054*^9}, {3.6576334574132833`*^9, 
   3.657633541028365*^9}, {3.657633647224779*^9, 3.65763365495891*^9}, {
   3.657634032782339*^9, 3.657634033790275*^9}, {3.65763422345969*^9, 
   3.6576342282674913`*^9}, {3.657634358198288*^9, 3.657634359508192*^9}, 
   3.657634622044037*^9, {3.658230094192687*^9, 3.658230170752303*^9}, {
   3.658230273562339*^9, 3.658230273786837*^9}, {3.658232062399374*^9, 
   3.658232077063816*^9}, {3.6582321707452593`*^9, 3.658232171607916*^9}, {
   3.658232676218773*^9, 3.658232800628454*^9}, {3.658506111783059*^9, 
   3.6585061864549513`*^9}, {3.658506476871106*^9, 3.65850647831612*^9}, {
   3.658506592408903*^9, 3.65850659693468*^9}, {3.658506750596529*^9, 
   3.65850675141868*^9}, {3.658506977999249*^9, 3.658507004160763*^9}, {
   3.658508534429098*^9, 3.658508538118112*^9}, {3.658508644857568*^9, 
   3.658508664697771*^9}, {3.6585089121430883`*^9, 3.658508943237472*^9}, {
   3.6585092172691717`*^9, 3.658509218354616*^9}, {3.658509318407297*^9, 
   3.658509318444787*^9}, {3.658509454442075*^9, 3.658509455887313*^9}, {
   3.6641127856747704`*^9, 3.66411280135459*^9}, {3.664112850220551*^9, 
   3.66411285034021*^9}, {3.6641141833503857`*^9, 3.664114190043103*^9}, {
   3.66411424860785*^9, 3.664114263685442*^9}, {3.66411449181011*^9, 
   3.664114491871812*^9}, {3.6641176634515257`*^9, 3.66411766622668*^9}, {
   3.6642186299444942`*^9, 3.664218631671126*^9}, {3.664221393813716*^9, 
   3.6642213998776703`*^9}, {3.6642224317650757`*^9, 3.664222432907764*^9}, {
   3.664226007548221*^9, 3.66422603250863*^9}, {3.664226077224358*^9, 
   3.664226154127267*^9}, {3.664278081044779*^9, 3.6642781280002403`*^9}, {
   3.664278180790661*^9, 3.664278182126803*^9}, {3.664278350482855*^9, 
   3.664278377801635*^9}, {3.664278475477022*^9, 3.664278475570146*^9}, {
   3.664553154183105*^9, 3.6645531579195213`*^9}, {3.664553209666206*^9, 
   3.664553209735475*^9}, {3.66455325504218*^9, 3.6645532592022057`*^9}, {
   3.664553584505393*^9, 3.66455358500663*^9}, {3.664553808573675*^9, 
   3.664553808795163*^9}, {3.6647409097889833`*^9, 3.664740975356249*^9}, {
   3.665083025836418*^9, 3.665083103311146*^9}, {3.665083144766101*^9, 
   3.665083151766548*^9}, {3.665083182649922*^9, 3.6650832113095016`*^9}, {
   3.665083321562745*^9, 3.6650834833638353`*^9}, {3.665083539316098*^9, 
   3.665083553097898*^9}, {3.665083611252768*^9, 3.6650836155012283`*^9}, {
   3.665083679573867*^9, 3.6650836907291327`*^9}, {3.665083726817916*^9, 
   3.6650837568885393`*^9}, {3.665083814122416*^9, 3.665083814310657*^9}, {
   3.665247498742773*^9, 3.665247593358732*^9}, {3.6652476324253283`*^9, 
   3.665247640679324*^9}, {3.6665317332965517`*^9, 3.666531821273624*^9}, 
   3.666532225700058*^9, {3.666532399406266*^9, 3.6665324129824047`*^9}, {
   3.6665327665588818`*^9, 3.666532772900305*^9}, {3.666532806871456*^9, 
   3.666532806996879*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Define ingredient functions", "Section",
 CellChangeTimes->{{3.637944423939974*^9, 3.637944429147876*^9}, {
   3.637944538470634*^9, 3.6379445394060097`*^9}, 3.647026651333486*^9, 
   3.6470267790957203`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Alpha]", "[", 
      RowBox[{"\[Sigma]i_", ",", "\[Sigma]j_", ",", "\[Omega]_"}], "]"}], "[", 
     RowBox[{"\[Mu]i_", ",", "\[Mu]j_"}], "]"}], ":=", 
    RowBox[{"\[Omega]", "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"E", "^", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Mu]i", "-", "\[Mu]j"}], ")"}], "^", "2"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Sigma]i", "^", "2"}], "+", 
               RowBox[{"\[Sigma]j", "^", "2"}]}], ")"}]}], "+", 
            RowBox[{"\[Omega]", "^", "2"}]}], ")"}]}], ")"}]}], "*", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"2", "*", 
          RowBox[{"\[Sigma]i", "^", "2"}]}], "+", 
         RowBox[{"2", "*", 
          RowBox[{"\[Sigma]j", "^", "2"}]}], "+", 
         RowBox[{"\[Omega]", "^", "2"}]}], "]"}]}], ")"}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Competitive", " ", "effect", " ", "of", " ", "species", " ", "j", " ", 
    "on", " ", "species", " ", "i"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Beta]", "[", 
      RowBox[{"\[Sigma]i_", ",", "\[Sigma]j_", ",", "\[Omega]_"}], "]"}], "[", 
     RowBox[{"\[Mu]i_", ",", "\[Mu]j_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"2", "*", 
       RowBox[{"(", 
        RowBox[{"\[Mu]j", "-", "\[Mu]i"}], ")"}], "*", 
       RowBox[{"\[Sigma]i", "^", "2"}], "*", "\[Omega]"}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"E", "^", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Mu]i", "-", "\[Mu]j"}], ")"}], "^", "2"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Sigma]i", "^", "2"}], "+", 
               RowBox[{"\[Sigma]j", "^", "2"}]}], ")"}]}], "+", 
            RowBox[{"\[Omega]", "^", "2"}]}], ")"}]}], ")"}]}], "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "*", 
           RowBox[{"\[Sigma]i", "^", "2"}]}], "+", 
          RowBox[{"2", "*", 
           RowBox[{"\[Sigma]j", "^", "2"}]}], "+", 
          RowBox[{"\[Omega]", "^", "2"}]}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"3", "/", "2"}], ")"}]}]}], ")"}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Selective", " ", "pressure", " ", "exerted", " ", "by", " ", "species", 
    " ", "j", " ", "on", " ", "species", " ", "i"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"bshape", "\[Equal]", "1"}], ",", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"Rectangular", " ", "growth", " ", "function"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"g", "[", 
       RowBox[{"z_", ",", "\[Theta]_"}], "]"}], ":=", 
      RowBox[{"Piecewise", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{
            RowBox[{"-", "\[Theta]"}], "\[LessEqual]", "z", "\[LessEqual]", 
            "\[Theta]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "Default"}], "}"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"b", "[", 
        RowBox[{"\[Sigma]_", ",", "\[Theta]_"}], "]"}], "[", "\[Mu]_", "]"}], 
      ":=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Erf", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Theta]", "-", "\[Mu]"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Sqrt", "[", "2", "]"}], "*", "\[Sigma]"}], ")"}]}], 
          "]"}], "+", 
         RowBox[{"Erf", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Theta]", "+", "\[Mu]"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Sqrt", "[", "2", "]"}], "*", "\[Sigma]"}], ")"}]}], 
          "]"}]}], ")"}], "/", "2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"bbar", "[", 
        RowBox[{"\[Sigma]_", ",", "\[Theta]_"}], "]"}], "[", "\[Mu]_", "]"}], 
      ":=", 
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"E", "^", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"2", "*", "\[Theta]", "*", "\[Mu]"}], ")"}], "/", 
                RowBox[{"\[Sigma]", "^", "2"}]}], ")"}]}]}], ")"}], "*", 
           "\[Sigma]"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"E", "^", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"\[Theta]", "+", "\[Mu]"}], ")"}], "^", "2"}], "/", 
              RowBox[{"(", 
               RowBox[{"2", "*", 
                RowBox[{"\[Sigma]", "^", "2"}]}], ")"}]}], ")"}]}], "*", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"2", "*", "Pi"}], "]"}]}], ")"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"bhat", "[", 
        RowBox[{"\[Sigma]_", ",", "\[Theta]_"}], "]"}], "[", "\[Mu]_", "]"}], 
      ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"E", "^", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"2", "*", "\[Theta]", "*", "\[Mu]"}], ")"}], "/", 
                RowBox[{"\[Sigma]", "^", "2"}]}], ")"}]}], "*", 
             RowBox[{"(", 
              RowBox[{"\[Theta]", "-", "\[Mu]"}], ")"}], "*", "\[Sigma]"}], 
            ")"}]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Theta]", "+", "\[Mu]"}], ")"}], "*", "\[Sigma]"}]}], 
         ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Theta]", "+", "\[Mu]"}], ")"}], "^", "2"}], "/", 
             RowBox[{"(", 
              RowBox[{"2", "*", 
               RowBox[{"\[Sigma]", "^", "2"}]}], ")"}]}], ")"}]}], "*", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"2", "*", "Pi"}], "]"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Sigma]", "^", "2"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Erf", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Theta]", "-", "\[Mu]"}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Sqrt", "[", "2", "]"}], "*", "\[Sigma]"}], ")"}]}], 
             "]"}], "+", 
            RowBox[{"Erf", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Theta]", "+", "\[Mu]"}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Sqrt", "[", "2", "]"}], "*", "\[Sigma]"}], ")"}]}], 
             "]"}]}], ")"}]}], ")"}], "/", "2"}]}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"bshape", "\[Equal]", "2"}], ",", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"Quadratic", " ", "growth", " ", "function"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"g", "[", 
       RowBox[{"z_", ",", "\[Theta]_"}], "]"}], ":=", 
      RowBox[{"Piecewise", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "-", 
            RowBox[{
             RowBox[{"z", "^", "2"}], "/", 
             RowBox[{"\[Theta]", "^", "2"}]}]}], ",", 
           RowBox[{
            RowBox[{"-", "\[Theta]"}], "\[LessEqual]", "z", "\[LessEqual]", 
            "\[Theta]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "Default"}], "}"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"b", "[", 
        RowBox[{"\[Sigma]_", ",", "\[Theta]_"}], "]"}], "[", "\[Mu]_", "]"}], 
      ":=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Theta]", "-", "\[Mu]"}], ")"}], "^", "2"}], "/", 
             RowBox[{"(", 
              RowBox[{"2", "*", 
               RowBox[{"\[Sigma]", "^", "2"}]}], ")"}]}], ")"}]}], "*", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"2", "/", "Pi"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{"\[Theta]", "-", "\[Mu]", "+", 
            RowBox[{
             RowBox[{"E", "^", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"2", "*", "\[Theta]", "*", "\[Mu]"}], ")"}], "/", 
                RowBox[{"\[Sigma]", "^", "2"}]}], ")"}]}], "*", 
             RowBox[{"(", 
              RowBox[{"\[Theta]", "+", "\[Mu]"}], ")"}]}]}], ")"}], "*", 
          "\[Sigma]"}], "+", 
         RowBox[{
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Theta]", "^", "2"}], "+", 
               RowBox[{"\[Mu]", "^", "2"}]}], ")"}], "/", 
             RowBox[{"\[Sigma]", "^", "2"}]}], ")"}]}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Theta]", "^", "2"}], "-", 
            RowBox[{"\[Mu]", "^", "2"}], "-", 
            RowBox[{"\[Sigma]", "^", "2"}]}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Erf", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Theta]", "-", "\[Mu]"}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Sqrt", "[", "2", "]"}], "*", "\[Sigma]"}], ")"}]}], 
             "]"}], "+", 
            RowBox[{"Erf", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Theta]", "+", "\[Mu]"}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Sqrt", "[", "2", "]"}], "*", "\[Sigma]"}], ")"}]}], 
             "]"}]}], ")"}]}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"2", "*", 
         RowBox[{"E", "^", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Theta]", "^", "2"}], "+", 
              RowBox[{"\[Mu]", "^", "2"}]}], ")"}], "/", 
            RowBox[{"\[Sigma]", "^", "2"}]}], ")"}]}], "*", 
         RowBox[{"\[Theta]", "^", "2"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"bbar", "[", 
        RowBox[{"\[Sigma]_", ",", "\[Theta]_"}], "]"}], "[", "\[Mu]_", "]"}], 
      ":=", 
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Sigma]", "^", "2"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"E", "^", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[Theta]", "-", "\[Mu]"}], ")"}], "^", "2"}], 
                   "/", 
                   RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"\[Sigma]", "^", "2"}]}], ")"}]}], ")"}]}], "-", 
                RowBox[{"E", "^", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[Theta]", "+", "\[Mu]"}], ")"}], "^", "2"}], 
                   "/", 
                   RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"\[Sigma]", "^", "2"}]}], ")"}]}], ")"}]}]}], 
               ")"}], "*", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"2", "/", "Pi"}], "]"}], "*", "\[Sigma]"}], "+", 
             RowBox[{
              RowBox[{"E", "^", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"\[Theta]", "^", "2"}], "+", 
                   RowBox[{"\[Mu]", "^", "2"}]}], ")"}], "/", 
                 RowBox[{"\[Sigma]", "^", "2"}]}], ")"}]}], "*", "\[Mu]", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Erf", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"\[Theta]", "-", "\[Mu]"}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", "\[Sigma]"}], 
                   ")"}]}], "]"}], "+", 
                RowBox[{"Erf", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"\[Theta]", "+", "\[Mu]"}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", "\[Sigma]"}], 
                   ")"}]}], "]"}]}], ")"}]}]}], ")"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"E", "^", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Theta]", "^", "2"}], "+", 
                RowBox[{"\[Mu]", "^", "2"}]}], ")"}], "/", 
              RowBox[{"\[Sigma]", "^", "2"}]}], ")"}]}], "*", 
           RowBox[{"\[Theta]", "^", "2"}]}], ")"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"bhat", "[", 
        RowBox[{"\[Sigma]_", ",", "\[Theta]_"}], "]"}], "[", "\[Mu]_", "]"}], 
      ":=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Sigma]", "^", "2"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Sqrt", "[", 
               RowBox[{"2", "/", "Pi"}], "]"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"3", "*", "\[Theta]"}], "-", "\[Mu]", "+", 
                RowBox[{
                 RowBox[{"E", "^", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"2", "*", "\[Theta]", "*", "\[Mu]"}], ")"}], "/", 
                    
                    RowBox[{"\[Sigma]", "^", "2"}]}], ")"}]}], "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"3", "*", "\[Theta]"}], "+", "\[Mu]"}], ")"}]}]}], 
               ")"}], "*", "\[Sigma]"}], ")"}], "/", 
            RowBox[{"E", "^", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\[Theta]", "+", "\[Mu]"}], ")"}], "^", "2"}], "/", 
               RowBox[{"(", 
                RowBox[{"2", "*", 
                 RowBox[{"\[Sigma]", "^", "2"}]}], ")"}]}], ")"}]}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Theta]", "^", "2"}], "-", 
              RowBox[{"\[Mu]", "^", "2"}], "-", 
              RowBox[{"3", "*", 
               RowBox[{"\[Sigma]", "^", "2"}]}]}], ")"}], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Erf", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\[Theta]", "-", "\[Mu]"}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Sqrt", "[", "2", "]"}], "*", "\[Sigma]"}], ")"}]}],
                "]"}], "+", 
              RowBox[{"Erf", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\[Theta]", "+", "\[Mu]"}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Sqrt", "[", "2", "]"}], "*", "\[Sigma]"}], ")"}]}],
                "]"}]}], ")"}]}]}], ")"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"2", "*", 
         RowBox[{"\[Theta]", "^", "2"}]}], ")"}]}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"bshape", "\[Equal]", "3"}], ",", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"Triangular", " ", "growth", " ", "function"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"g", "[", 
       RowBox[{"z_", ",", "\[Theta]_"}], "]"}], ":=", 
      RowBox[{"Piecewise", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"z", "+", "\[Theta]"}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"2", "*", "\[Theta]"}], ")"}]}], ",", 
           RowBox[{
            RowBox[{"-", "\[Theta]"}], "\[LessEqual]", "z", "\[LessEqual]", 
            "\[Theta]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "Default"}], "}"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"b", "[", 
        RowBox[{"\[Sigma]_", ",", "\[Theta]_"}], "]"}], "[", "\[Mu]_", "]"}], 
      ":=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"E", "^", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"2", "*", "\[Theta]", "*", "\[Mu]"}], ")"}], "/", 
                   
                   RowBox[{"\[Sigma]", "^", "2"}]}], ")"}]}]}], ")"}], "*", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"2", "/", "Pi"}], "]"}], "*", "\[Sigma]"}], ")"}], "/", 
            RowBox[{"E", "^", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\[Theta]", "+", "\[Mu]"}], ")"}], "^", "2"}], "/", 
               RowBox[{"(", 
                RowBox[{"2", "*", 
                 RowBox[{"\[Sigma]", "^", "2"}]}], ")"}]}], ")"}]}]}], 
           ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Theta]", "+", "\[Mu]"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Erf", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Theta]", "-", "\[Mu]"}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Sqrt", "[", "2", "]"}], "*", "\[Sigma]"}], ")"}]}], 
             "]"}], "+", 
            RowBox[{"Erf", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Theta]", "+", "\[Mu]"}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Sqrt", "[", "2", "]"}], "*", "\[Sigma]"}], ")"}]}], 
             "]"}]}], ")"}]}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"4", "*", "\[Theta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"bbar", "[", 
        RowBox[{"\[Sigma]_", ",", "\[Theta]_"}], "]"}], "[", "\[Mu]_", "]"}], 
      ":=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{"\[Sigma]", "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"E", "^", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\[Theta]", "-", "\[Mu]"}], ")"}], "^", "2"}], "/", 
               RowBox[{"(", 
                RowBox[{"2", "*", 
                 RowBox[{"\[Sigma]", "^", "2"}]}], ")"}]}], ")"}]}], "*", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"2", "*", "Pi"}], "]"}]}], ")"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Sigma]", "^", "2"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Erf", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Theta]", "-", "\[Mu]"}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Sqrt", "[", "2", "]"}], "*", "\[Sigma]"}], ")"}]}], 
             "]"}], "+", 
            RowBox[{"Erf", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Theta]", "+", "\[Mu]"}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Sqrt", "[", "2", "]"}], "*", "\[Sigma]"}], ")"}]}], 
             "]"}]}], ")"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"4", "*", "\[Theta]"}], ")"}]}]}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"bpert", "[", 
      RowBox[{"\[Sigma]_", ",", "\[Theta]_", ",", "c_"}], "]"}], "[", 
     "\[Mu]_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"c", "*", "\[Mu]"}]}], ")"}], "*", 
      RowBox[{
       RowBox[{"b", "[", 
        RowBox[{"\[Sigma]", ",", "\[Theta]"}], "]"}], "[", "\[Mu]", "]"}]}], 
     "+", 
     RowBox[{"c", "*", 
      RowBox[{
       RowBox[{"bbar", "[", 
        RowBox[{"\[Sigma]", ",", "\[Theta]"}], "]"}], "[", "\[Mu]", 
       "]"}]}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Perturbed", " ", "growth", " ", "function"}], ";", " ", 
    RowBox[{
    "the", " ", "parameter", " ", "c", " ", "measures", " ", "the", " ", 
     "degree", " ", "of", " ", "asymmetry"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"bbarpert", "[", 
      RowBox[{"\[Sigma]_", ",", "\[Theta]_", ",", "c_"}], "]"}], "[", 
     "\[Mu]_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"c", "*", "\[Mu]"}]}], ")"}], "*", 
      RowBox[{
       RowBox[{"bbar", "[", 
        RowBox[{"\[Sigma]", ",", "\[Theta]"}], "]"}], "[", "\[Mu]", "]"}]}], 
     "+", 
     RowBox[{"c", "*", 
      RowBox[{
       RowBox[{"bhat", "[", 
        RowBox[{"\[Sigma]", ",", "\[Theta]"}], "]"}], "[", "\[Mu]", 
       "]"}]}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Perturbed", " ", "selective", " ", "pressure", " ", "caused", " ", "by", 
     " ", "growth"}], ";", " ", 
    RowBox[{
    "the", " ", "parameter", " ", "c", " ", "measures", " ", "the", " ", 
     "degree", " ", "of", " ", "asymmetry"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"cutoff", "[", "n_", "]"}], ":=", 
    RowBox[{"Piecewise", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"3", "*", 
           RowBox[{
            RowBox[{"n", "^", "2"}], "/", 
            RowBox[{"alleethreshold", "^", "2"}]}]}], "-", 
          RowBox[{"2", "*", 
           RowBox[{
            RowBox[{"n", "^", "3"}], "/", 
            RowBox[{"alleethreshold", "^", "3"}]}]}]}], ",", 
         RowBox[{
         "0", "\[LessEqual]", "n", "\[LessEqual]", "alleethreshold"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"n", ">", "alleethreshold"}]}], "}"}]}], "}"}], "]"}]}], 
   ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "This", " ", "function", " ", "is", " ", "equal", " ", "to", " ", "1", 
     " ", "for", " ", "n", " ", "greater", " ", "than", " ", "the", " ", 
     "Allee", " ", "threshold"}], ",", " ", 
    RowBox[{"to", " ", "0", " ", "for", " ", "n", " ", "negative"}], ",", " ", 
    RowBox[{
     RowBox[{
     "and", " ", "varies", " ", "smoothly", " ", "as", " ", "a", " ", "cubic",
       " ", "function", " ", "in", " ", 
      RowBox[{"between", ".", " ", "One"}], " ", "can", " ", "think", " ", 
      "of", " ", "this", " ", "as", " ", "a", " ", "smoothed", " ", "step", 
      " ", "function"}], ";", " ", 
     RowBox[{
     "its", " ", "role", " ", "is", " ", "to", " ", "prevent", " ", "species",
       " ", "abundances", " ", "that", " ", "fall", " ", "too", " ", "low", 
      " ", "to", " ", "reach", " ", "negative", " ", "values", " ", "due", 
      " ", "to", " ", "numerical", " ", "error"}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"dndt", "[", 
     RowBox[{"i_", ",", "t_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"n", "[", "i", "]"}], "[", "t", "]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"bpert", "[", 
         RowBox[{
          RowBox[{"\[Sigma]", "[", "i", "]"}], ",", "\[Theta]", ",", "c"}], 
         "]"}], "[", 
        RowBox[{
         RowBox[{"\[Mu]", "[", "i", "]"}], "[", "t", "]"}], "]"}], "-", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[Alpha]", "[", 
            RowBox[{
             RowBox[{"\[Sigma]", "[", "i", "]"}], ",", 
             RowBox[{"\[Sigma]", "[", "j", "]"}], ",", "\[Omega]"}], "]"}], 
           "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Mu]", "[", "i", "]"}], "[", "t", "]"}], ",", 
            RowBox[{
             RowBox[{"\[Mu]", "[", "j", "]"}], "[", "t", "]"}]}], "]"}], "*", 
          
          RowBox[{
           RowBox[{"n", "[", "j", "]"}], "[", "t", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "S"}], "}"}]}], "]"}]}], ")"}], "*", 
     RowBox[{"cutoff", "[", 
      RowBox[{
       RowBox[{"n", "[", "i", "]"}], "[", "t", "]"}], "]"}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Right", " ", "hand", " ", "side", " ", "of", " ", "equation", " ", 
    "governing", " ", "the", " ", 
    RowBox[{"densities", ".", " ", "Notice"}], " ", "that", " ", "it", " ", 
    "is", " ", "multiplied", " ", "by", " ", 
    RowBox[{"cutoff", "[", 
     RowBox[{
      RowBox[{"n", "[", "i", "]"}], "[", "t", "]"}], "]"}], " ", "to", " ", 
    "prevent", " ", "the", " ", "abundances", " ", "from", " ", "getting", 
    " ", "negative", " ", "due", " ", "to", " ", "numerical", " ", 
    RowBox[{"error", ".", " ", "This"}], " ", "may", " ", "also", " ", "be", 
    " ", "thought", " ", "of", " ", "as", " ", "an", " ", "effective", " ", 
    "weak", " ", "Allee", " ", "effect", " ", "reducing", " ", "the", " ", 
    "growth", " ", "rate", " ", "of", " ", "very", " ", "small", " ", 
    "populations"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"d\[Mu]dt", "[", 
     RowBox[{"i_", ",", "t_", ",", "hsquare_"}], "]"}], ":=", 
    RowBox[{"hsquare", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"bbarpert", "[", 
         RowBox[{
          RowBox[{"\[Sigma]", "[", "i", "]"}], ",", "\[Theta]", ",", "c"}], 
         "]"}], "[", 
        RowBox[{
         RowBox[{"\[Mu]", "[", "i", "]"}], "[", "t", "]"}], "]"}], "-", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[Beta]", "[", 
            RowBox[{
             RowBox[{"\[Sigma]", "[", "i", "]"}], ",", 
             RowBox[{"\[Sigma]", "[", "j", "]"}], ",", "\[Omega]"}], "]"}], 
           "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Mu]", "[", "i", "]"}], "[", "t", "]"}], ",", 
            RowBox[{
             RowBox[{"\[Mu]", "[", "j", "]"}], "[", "t", "]"}]}], "]"}], "*", 
          
          RowBox[{
           RowBox[{"n", "[", "j", "]"}], "[", "t", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "S"}], "}"}]}], "]"}]}], ")"}]}]}], 
   ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Right", " ", "hand", " ", "side", " ", "of", " ", "equation", " ", 
    "governing", " ", "the", " ", "trait", " ", "means"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rhs", "[", "t_", "]"}], ":=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"dndt", "[", 
         RowBox[{"i", ",", "t"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "S"}], "}"}]}], "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"d\[Mu]dt", "[", 
         RowBox[{"i", ",", "t", ",", "hsquare"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "S"}], "}"}]}], "]"}]}], "]"}]}], ";"}], 
  " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Join", " ", "the", " ", "right", " ", "hand", " ", "sides", " ", "of", 
      " ", "the", " ", "density"}], "-", " ", 
     RowBox[{
     "and", " ", "trait", " ", "mean", " ", "equations", " ", "into", " ", 
      "a", " ", "single", " ", "vector", " ", 
      RowBox[{"rhs", "[", 
       RowBox[{"t", ",", "hsquare"}], "]"}]}]}], ",", " ", 
    RowBox[{
    "where", " ", "hsquare", " ", "is", " ", "the", " ", "heritability"}]}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vars", ":=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"n", "[", "i", "]"}], "[", "t", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "S"}], "}"}]}], "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Mu]", "[", "i", "]"}], "[", "t", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "S"}], "}"}]}], "]"}]}], "]"}]}], ";"}], 
  " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Dynamical", " ", 
    RowBox[{"variables", ":", " ", 
     RowBox[{
     "population", " ", "densities", " ", "and", " ", "trait", " ", 
      "means"}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"eqs", ":=", 
    RowBox[{"Thread", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"vars", ",", "t"}], "]"}], "\[Equal]", 
      RowBox[{"rhs", "[", "t", "]"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"All", " ", "equations"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"initialcond", ":=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"n", "[", "i", "]"}], "[", "0", "]"}], "\[Equal]", 
         RowBox[{
         "ninit", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "S"}], "}"}]}], "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"\[Mu]", "[", "i", "]"}], "[", "0", "]"}], "\[Equal]", 
         RowBox[{
         "\[Mu]init", "\[LeftDoubleBracket]", "i", 
          "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "S"}], "}"}]}], "]"}]}], "]"}]}], ";"}], 
  " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Initial", " ", "conditions"}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.586111548165182*^9, 3.586111610052083*^9}, {
   3.5980382284214287`*^9, 3.598038235478167*^9}, {3.5980390889468718`*^9, 
   3.598039091239702*^9}, {3.598039240998757*^9, 3.598039242867353*^9}, {
   3.636048316366757*^9, 3.636048352533709*^9}, {3.636048400672244*^9, 
   3.636048470522504*^9}, {3.636119192964542*^9, 3.636119193475746*^9}, {
   3.636119913004284*^9, 3.636119946471274*^9}, {3.636120112155159*^9, 
   3.636120117822342*^9}, {3.636120243744546*^9, 3.6361202482892513`*^9}, {
   3.636120488085433*^9, 3.636120492785737*^9}, {3.6361208570858917`*^9, 
   3.636120869947782*^9}, {3.636136725142221*^9, 3.636136728911707*^9}, {
   3.636136941215989*^9, 3.636136979644793*^9}, {3.636214621484564*^9, 
   3.6362146692532587`*^9}, {3.63622199007609*^9, 3.636221990545699*^9}, {
   3.6362233073163137`*^9, 3.6362233077636223`*^9}, {3.6362233671175823`*^9, 
   3.636223367706605*^9}, {3.636223439879025*^9, 3.636223442723281*^9}, {
   3.636224140476626*^9, 3.636224161468769*^9}, {3.636308586065815*^9, 
   3.636308586369863*^9}, {3.636308632865573*^9, 3.636308640509128*^9}, {
   3.636308715435882*^9, 3.63630871657193*^9}, {3.636309362304088*^9, 
   3.636309363883092*^9}, {3.636309567467848*^9, 3.6363095689872513`*^9}, {
   3.6363096677096157`*^9, 3.636309667988961*^9}, {3.636309920498577*^9, 
   3.636309922158874*^9}, {3.6363104481163054`*^9, 3.636310448336007*^9}, {
   3.636310552565816*^9, 3.636310557469852*^9}, {3.6363106652645817`*^9, 
   3.636310670100184*^9}, {3.636310758312335*^9, 3.6363107644551573`*^9}, {
   3.637145205774474*^9, 3.637145215458947*^9}, {3.637145278907963*^9, 
   3.637145280078137*^9}, {3.6372618918911667`*^9, 3.63726192464246*^9}, {
   3.637263650204802*^9, 3.637263653149817*^9}, {3.637267053040724*^9, 
   3.637267053252308*^9}, {3.637322770453776*^9, 3.637322845345935*^9}, {
   3.63732294861764*^9, 3.637322960908021*^9}, {3.637323784305043*^9, 
   3.637323854471548*^9}, {3.637324392754588*^9, 3.6373243936320353`*^9}, {
   3.637324967430126*^9, 3.637324967606785*^9}, {3.637325619443431*^9, 
   3.637325619668119*^9}, {3.637326080938013*^9, 3.6373261090903273`*^9}, {
   3.637326246032735*^9, 3.637326247355034*^9}, {3.6373262878947363`*^9, 
   3.637326291793219*^9}, {3.6373274808007727`*^9, 3.637327484051203*^9}, {
   3.637327862243657*^9, 3.637327871497875*^9}, 3.637327910328018*^9, {
   3.637333328196549*^9, 3.637333358834331*^9}, {3.637333393385459*^9, 
   3.637333463286395*^9}, {3.637333590616605*^9, 3.637333592319993*^9}, 
   3.637344144151408*^9, {3.637344201252043*^9, 3.6373442022466917`*^9}, {
   3.637344666756873*^9, 3.6373447768924227`*^9}, {3.6373448575796537`*^9, 
   3.6373448645349817`*^9}, {3.6373454072229233`*^9, 3.637345427130397*^9}, {
   3.637345888265977*^9, 3.637345894137508*^9}, {3.6373469150968657`*^9, 
   3.637346915815628*^9}, {3.637347031195343*^9, 3.637347035473156*^9}, {
   3.637347138754732*^9, 3.63734716791269*^9}, {3.6373473486321373`*^9, 
   3.637347348810842*^9}, {3.637348219072146*^9, 3.637348276214505*^9}, {
   3.637348497441474*^9, 3.637348507953807*^9}, {3.63734858873954*^9, 
   3.637348672278315*^9}, {3.637407405074037*^9, 3.63740740608319*^9}, {
   3.637407453749281*^9, 3.637407454914338*^9}, {3.637407871578339*^9, 
   3.637407871946087*^9}, {3.6374093164974413`*^9, 3.637409343175494*^9}, {
   3.637409382108288*^9, 3.637409383764339*^9}, {3.637409484713635*^9, 
   3.637409487445712*^9}, {3.63740956287272*^9, 3.637409563014326*^9}, {
   3.637409718198373*^9, 3.637409718486182*^9}, {3.637409806318481*^9, 
   3.6374098482926407`*^9}, {3.6374103758828077`*^9, 3.637410375980948*^9}, {
   3.637424753708479*^9, 3.637424754022253*^9}, {3.63742478509352*^9, 
   3.637424867202922*^9}, {3.637436986487465*^9, 3.637436993044979*^9}, {
   3.637437047694839*^9, 3.6374370507592487`*^9}, {3.637494852451009*^9, 
   3.637494857769236*^9}, {3.63749492446222*^9, 3.6374949529269667`*^9}, {
   3.637519167408764*^9, 3.637519217194662*^9}, {3.63759681164513*^9, 
   3.63759684082777*^9}, {3.637596917014776*^9, 3.637596921155765*^9}, {
   3.6375970079671383`*^9, 3.637597013172229*^9}, {3.637597069743931*^9, 
   3.6375970744815063`*^9}, {3.637597211027948*^9, 3.63759721397069*^9}, {
   3.637597273404606*^9, 3.63759727630398*^9}, {3.6375976388455067`*^9, 
   3.637597642103622*^9}, {3.637597710019989*^9, 3.637597711893298*^9}, {
   3.6375979693919086`*^9, 3.637597973647732*^9}, {3.637598323919444*^9, 
   3.637598357293708*^9}, {3.6375984033009987`*^9, 3.637598535364273*^9}, {
   3.637598601428303*^9, 3.6375986029157667`*^9}, {3.6375986793185377`*^9, 
   3.637598680409795*^9}, {3.63759907463617*^9, 3.637599101932703*^9}, {
   3.63760316425942*^9, 3.6376031658436127`*^9}, {3.63760335346523*^9, 
   3.6376033550754547`*^9}, {3.637607611552732*^9, 3.637607630330983*^9}, {
   3.637944445767995*^9, 3.637944464630939*^9}, {3.638019210288746*^9, 
   3.63801922623518*^9}, {3.638099132779462*^9, 3.638099312451859*^9}, {
   3.638099494387038*^9, 3.638099494734231*^9}, {3.638111919314369*^9, 
   3.6381119276441097`*^9}, {3.638366034403055*^9, 3.638366034936071*^9}, {
   3.638366229210598*^9, 3.638366234389937*^9}, {3.6385342825202217`*^9, 
   3.638534342830737*^9}, 3.6385344282336206`*^9, {3.6385535771703987`*^9, 
   3.638553591188921*^9}, {3.639068287785529*^9, 3.639068401243074*^9}, {
   3.63906856176612*^9, 3.639068584169223*^9}, {3.639069240571207*^9, 
   3.639069310385165*^9}, {3.6390693479949493`*^9, 3.639069367955043*^9}, {
   3.639069404129765*^9, 3.6390694242513027`*^9}, 3.639069456373783*^9, {
   3.639069647518208*^9, 3.639069653747018*^9}, {3.639070332869918*^9, 
   3.639070373634324*^9}, {3.639070490529275*^9, 3.6390705347456303`*^9}, 
   3.639070582792553*^9, {3.639070624053755*^9, 3.6390706467552977`*^9}, {
   3.639081575680254*^9, 3.639081578395834*^9}, {3.6427661739795713`*^9, 
   3.642766197079878*^9}, {3.6427662398475447`*^9, 3.642766330255218*^9}, {
   3.642766457315612*^9, 3.642766475747069*^9}, {3.6471672944538307`*^9, 
   3.647167294816352*^9}, {3.653242267034561*^9, 3.653242292860064*^9}, {
   3.653242495154902*^9, 3.653242548499192*^9}, {3.6532425853261757`*^9, 
   3.653242607831604*^9}, 3.653242701914527*^9, 3.653242754762661*^9, {
   3.653242813751082*^9, 3.6532429205112123`*^9}, {3.653243174975437*^9, 
   3.65324317517656*^9}, {3.653405195870864*^9, 3.6534052224204903`*^9}, {
   3.653405266481648*^9, 3.653405275906554*^9}, 3.653405313458679*^9, {
   3.653405374593347*^9, 3.653405392418694*^9}, {3.653405483030053*^9, 
   3.65340560527682*^9}, {3.65581606161007*^9, 3.655816124263091*^9}, {
   3.655816206222122*^9, 3.6558162062730093`*^9}, {3.657200207553339*^9, 
   3.657200257038213*^9}, {3.657200531282445*^9, 3.657200543857582*^9}, {
   3.657200642086091*^9, 3.657200652226026*^9}, {3.657200761383958*^9, 
   3.657200766198987*^9}, {3.658230381525301*^9, 3.658230401712922*^9}, {
   3.664277767065587*^9, 3.664277874859643*^9}, {3.664278194987823*^9, 
   3.664278208226695*^9}, {3.66455334436705*^9, 3.6645533844036627`*^9}, 
   3.6645534380629597`*^9, {3.664553497838634*^9, 3.664553519309924*^9}, 
   3.66455358004491*^9, {3.664553751049549*^9, 3.664553751726994*^9}, {
   3.664553825122072*^9, 3.664553826588015*^9}, {3.664553868091168*^9, 
   3.664553868822193*^9}, {3.664553908268156*^9, 3.664553910560994*^9}, {
   3.664553946555661*^9, 3.664553956524678*^9}, {3.664554024286304*^9, 
   3.6645540510865707`*^9}, {3.664559694445292*^9, 3.664559711520198*^9}, {
   3.666531840225725*^9, 3.666531970435521*^9}, {3.6665320039407463`*^9, 
   3.666532026856133*^9}, {3.666532068992281*^9, 3.6665321332074423`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Simulate model", "Section",
 CellChangeTimes->{{3.63794449425334*^9, 3.637944496316498*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"tmax", "=", "2000"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Number", " ", "of", " ", "time", " ", "units", " ", "to", " ", "simulate",
     " ", "model", " ", "for"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sol", "=", 
    RowBox[{"NDSolve", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{"eqs", ",", "initialcond"}], "]"}], ",", "vars", ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "0", ",", "tmax"}], "}"}], ",", 
      RowBox[{"MaxSteps", "\[Rule]", "\[Infinity]"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Solve", " ", "equations"}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{
  3.647684268932349*^9, {3.647684401876405*^9, 3.647684480175918*^9}, {
   3.647684707535428*^9, 3.647684711207245*^9}, {3.6476849856489477`*^9, 
   3.647684992408437*^9}, {3.6476850822391443`*^9, 3.647685082366844*^9}, {
   3.647685115172162*^9, 3.6476851182922173`*^9}, {3.6476852026140327`*^9, 
   3.6476852170863037`*^9}, {3.647685281587213*^9, 3.647685281698996*^9}, 
   3.64768698786467*^9, {3.6476871426355743`*^9, 3.6476871693928337`*^9}, 
   3.647687392029759*^9, {3.647687436074444*^9, 3.647687436312481*^9}, {
   3.647687578384244*^9, 3.647687578423888*^9}, 3.647687687082264*^9, 
   3.647687789988652*^9, {3.647687848905538*^9, 3.647687875634366*^9}, {
   3.6476924544694033`*^9, 3.647692458499258*^9}, {3.64769369504167*^9, 
   3.647693695161495*^9}, {3.6477026916780663`*^9, 3.647702691932436*^9}, {
   3.647702813137446*^9, 3.647702862479265*^9}, {3.647702908673418*^9, 
   3.6477029088416843`*^9}, {3.647702967412312*^9, 3.647702967932753*^9}, {
   3.647703003869831*^9, 3.647703004251945*^9}, {3.647703054071562*^9, 
   3.647703082684827*^9}, {3.6477031306090183`*^9, 3.647703130790914*^9}, {
   3.647703383070218*^9, 3.6477033994541597`*^9}, 3.647703430774939*^9, {
   3.647703474677704*^9, 3.647703500102302*^9}, {3.647703539673356*^9, 
   3.647703539780864*^9}, {3.647703574197402*^9, 3.6477035744570713`*^9}, 
   3.647703622962994*^9, {3.647703742796646*^9, 3.647703742859317*^9}, {
   3.6477037964739237`*^9, 3.64770379653021*^9}, {3.6477039000882*^9, 
   3.647703904844276*^9}, {3.647704563034483*^9, 3.647704563170415*^9}, 
   3.647704615328841*^9, 3.647704660648161*^9, 3.6477047010165377`*^9, 
   3.647705019480432*^9, {3.647705067634281*^9, 3.647705067829558*^9}, {
   3.647705108846363*^9, 3.647705108902315*^9}, 3.647705147887721*^9, {
   3.647705186076606*^9, 3.6477051862635612`*^9}, {3.6477052379896317`*^9, 
   3.647705238242844*^9}, {3.647705442222454*^9, 3.6477054926019163`*^9}, {
   3.647705529459362*^9, 3.6477055299060926`*^9}, 3.647705599140663*^9, {
   3.6477056963461933`*^9, 3.6477057023380947`*^9}, 3.6477060842471123`*^9, 
   3.647706220309449*^9, 3.64770725542371*^9, {3.64770728873631*^9, 
   3.647707288795506*^9}, {3.647707331770033*^9, 3.647707331892741*^9}, {
   3.647707401635479*^9, 3.6477074016706867`*^9}, 3.647707432178876*^9, {
   3.647707479536631*^9, 3.6477074809038267`*^9}, {3.647707571902152*^9, 
   3.647707572141252*^9}, 3.647707664264002*^9, {3.647709578424967*^9, 
   3.647709610664877*^9}, 3.6477105527995977`*^9, {3.6477147470180397`*^9, 
   3.6477147584321404`*^9}, {3.647714790282208*^9, 3.6477148261077433`*^9}, {
   3.647714909036601*^9, 3.647714968170123*^9}, {3.653242383628578*^9, 
   3.653242396179614*^9}, {3.65330119045608*^9, 3.653301190588052*^9}, 
   3.653301549359827*^9, 3.6534056836407423`*^9, {3.654520917149991*^9, 
   3.6545209172594347`*^9}, {3.655755689886771*^9, 3.655755747431713*^9}, {
   3.655755798025041*^9, 3.655755804721353*^9}, {3.6576320797781277`*^9, 
   3.657632082481557*^9}, {3.6576333271148653`*^9, 3.6576333429926577`*^9}, {
   3.6576334273810053`*^9, 3.65763342764224*^9}, {3.65823018281664*^9, 
   3.658230184794613*^9}, {3.658230295679965*^9, 3.658230320956111*^9}, {
   3.658230432839834*^9, 3.658230433599699*^9}, {3.658232183705521*^9, 
   3.6582321856492987`*^9}, {3.658232464733729*^9, 3.6582324668043222`*^9}, {
   3.6582328129013*^9, 3.658232814436957*^9}, {3.65850626914053*^9, 
   3.658506276402564*^9}, {3.658508958311071*^9, 3.658508982367446*^9}, {
   3.664114217126519*^9, 3.6641142173809433`*^9}, {3.664278229719193*^9, 
   3.664278232231831*^9}, {3.6642784689326878`*^9, 3.664278471348377*^9}, {
   3.6642811913294353`*^9, 3.664281193928712*^9}, {3.664553282971664*^9, 
   3.664553283086993*^9}, {3.665083165784397*^9, 3.665083166252859*^9}, 
   3.6650833998688107`*^9, 3.665083566136042*^9, {3.665083626112398*^9, 
   3.665083627050622*^9}, {3.6650836575473022`*^9, 3.665083657707643*^9}, {
   3.665083707124103*^9, 3.6650837120197153`*^9}, {3.665247663794414*^9, 
   3.665247664361267*^9}, {3.666532150382959*^9, 3.666532174888595*^9}, {
   3.666532302987706*^9, 3.6665323306830482`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plot results", "Section",
 CellChangeTimes->{{3.637944501469451*^9, 3.637944503436369*^9}}],

Cell["\<\
Three plots are made: time series of species densities, time series of \
species mean traits (with the standard deviation shown around the mean), and \
the community at the final state along the trait axis (red dashed line shows \
the shape of the growth function).\
\>", "Text",
 CellChangeTimes->{{3.66653247121439*^9, 3.666532585513073*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"plotdensities", "=", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"n", "[", "i", "]"}], "[", "t", "]"}], "/.", "sol"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "S"}], "}"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "tmax"}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "All"}], "}"}]}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"Axes", "\[Rule]", "False"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", "Thick", "}"}]}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Time\>\"", ",", "\"\<Population density\>\""}], "}"}]}], 
     ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", "14", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotmeantraits", "=", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{"Join", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Mu]", "[", "i", "]"}], "[", "t", "]"}], "/.", "sol"}],
            ")"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "S"}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Mu]", "[", "i", "]"}], "[", "t", "]"}], "/.", 
             "sol"}], ")"}], "+", 
           RowBox[{"\[Sigma]", "[", "i", "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "S"}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Mu]", "[", "i", "]"}], "[", "t", "]"}], "/.", 
             "sol"}], ")"}], "-", 
           RowBox[{"\[Sigma]", "[", "i", "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "S"}], "}"}]}], "]"}]}], "]"}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "tmax"}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"All", ",", "All"}], "}"}]}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Axes", "\[Rule]", "False"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Time\>\"", ",", "\"\<Trait value\>\""}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", "14", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ColorData", "[", 
             RowBox[{"97", ",", "i"}], "]"}], ",", "Thick"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "S"}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ColorData", "[", 
             RowBox[{"97", ",", "i"}], "]"}], ",", 
            RowBox[{"Opacity", "[", "0", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "S"}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ColorData", "[", 
             RowBox[{"97", ",", "i"}], "]"}], ",", 
            RowBox[{"Opacity", "[", "0", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "S"}], "}"}]}], "]"}]}], "]"}]}], ",", 
     
     RowBox[{"Filling", "\[Rule]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"i", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"i", "+", "S"}], "}"}]}], ",", 
          RowBox[{"i", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"i", "+", 
             RowBox[{"2", "*", "S"}]}], "}"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "S"}], "}"}]}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotfinalstate", "=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xlimit", "=", 
        RowBox[{"Min", "[", 
         RowBox[{"1", ",", 
          RowBox[{"Max", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Mu]", "[", "i", "]"}], "[", "t", "]"}], "/.", 
                  "sol"}], "/.", 
                 RowBox[{"t", "\[Rule]", "tmax"}]}], ")"}], "+", 
               RowBox[{"3", "*", 
                RowBox[{"\[Sigma]", "[", "i", "]"}]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "S"}], "}"}]}], "]"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Mu]", "[", "i", "]"}], "[", "t", "]"}], "/.", 
                  "sol"}], "/.", 
                 RowBox[{"t", "\[Rule]", "0"}]}], ")"}], "+", 
               RowBox[{"3", "*", 
                RowBox[{"\[Sigma]", "[", "i", "]"}]}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "S"}], "}"}]}], "]"}], ",", 
            RowBox[{"Abs", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Mu]", "[", "i", "]"}], "[", "t", "]"}], "/.", 
                   "sol"}], "/.", 
                  RowBox[{"t", "\[Rule]", "tmax"}]}], ")"}], "-", 
                RowBox[{"3", "*", 
                 RowBox[{"\[Sigma]", "[", "i", "]"}]}]}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "S"}], "}"}]}], "]"}], "]"}], ",", 
            RowBox[{"Abs", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Mu]", "[", "i", "]"}], "[", "t", "]"}], "/.", 
                   "sol"}], "/.", 
                  RowBox[{"t", "\[Rule]", "0"}]}], ")"}], "-", 
                RowBox[{"3", "*", 
                 RowBox[{"\[Sigma]", "[", "i", "]"}]}]}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "S"}], "}"}]}], "]"}], "]"}], ",",
             "0.6"}], "]"}]}], "]"}]}], ",", 
       RowBox[{"ylimit", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"n", "[", "i", "]"}], "[", "t", "]"}], "/.", "sol"}], 
              "/.", 
              RowBox[{"t", "\[Rule]", "tmax"}]}], ")"}], "/", 
            RowBox[{"Min", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Sqrt", "[", 
                RowBox[{"2", "*", "Pi", "*", 
                 RowBox[{
                  RowBox[{"\[Sigma]", "[", "j", "]"}], "^", "2"}]}], "]"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", "S"}], "}"}]}], "]"}], "]"}]}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "S"}], "}"}]}], "]"}], "]"}]}]}], 
      "}"}], ",", 
     RowBox[{"Show", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"z", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"\[Mu]", "[", "i", "]"}], "[", "t", "]"}], "/.", 
                    "sol"}], ")"}]}], ")"}], "^", "2"}]}], "/", 
                 RowBox[{"(", 
                  RowBox[{"2", "*", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[Sigma]", "[", "i", "]"}], ")"}], "^", "2"}]}], 
                  ")"}]}], "]"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Sigma]", "[", "i", "]"}], "*", 
                 RowBox[{"Sqrt", "[", 
                  RowBox[{"2", "*", "Pi"}], "]"}]}], ")"}]}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"n", "[", "i", "]"}], "[", "t", "]"}], "/.", "sol"}],
                ")"}]}], "/.", 
             RowBox[{"t", "\[Rule]", "tmax"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "S"}], "}"}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"z", ",", 
           RowBox[{"-", "xlimit"}], ",", "xlimit"}], "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"1.02", "*", "ylimit"}]}], "}"}]}], "}"}]}], ",", 
         RowBox[{"Filling", "\[Rule]", "Axis"}], ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"Axes", "\[Rule]", "False"}], ",", 
         RowBox[{"PlotPoints", "\[Rule]", "1000"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<Trait value\>\"", ",", "\"\<Density\>\""}], "}"}]}], 
         ",", 
         RowBox[{"FrameStyle", "\[Rule]", 
          RowBox[{"Directive", "[", "14", "]"}]}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"z", ",", "\[Theta]"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"c", "*", "z"}]}], ")"}], "*", "ylimit"}], ",", 
         RowBox[{"{", 
          RowBox[{"z", ",", 
           RowBox[{"-", "xlimit"}], ",", "xlimit"}], "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
         RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Darker", "[", "Red", "]"}], ",", "Dashed", ",", 
            RowBox[{"Opacity", "[", "0.4", "]"}]}], "}"}]}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"GraphicsColumn", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"plotdensities", ",", "plotmeantraits", ",", "plotfinalstate"}], 
    "}"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.638099562121078*^9, 3.638099625212118*^9}, {
   3.6381000169792967`*^9, 3.638100069786745*^9}, {3.638103294883561*^9, 
   3.638103298351755*^9}, {3.638286731022518*^9, 3.638286762547596*^9}, {
   3.638286883543002*^9, 3.63828697027147*^9}, {3.63828700455233*^9, 
   3.638287012783333*^9}, {3.6383982398042927`*^9, 3.638398254945826*^9}, {
   3.638611955300756*^9, 3.638612065398313*^9}, {3.638618319614079*^9, 
   3.638618319781139*^9}, {3.642517574675741*^9, 3.642517616275386*^9}, {
   3.642517875109436*^9, 3.6425178793185177`*^9}, {3.642769497454034*^9, 
   3.64276954542822*^9}, {3.6427789421712914`*^9, 3.642778969640601*^9}, {
   3.6427797814656067`*^9, 3.642779784094695*^9}, {3.642783399779513*^9, 
   3.6427834090516033`*^9}, {3.642783871339809*^9, 3.642783897501967*^9}, {
   3.64295262281638*^9, 3.64295263450179*^9}, {3.653242964614781*^9, 
   3.653242964931179*^9}, {3.653301572833681*^9, 3.6533015735312757`*^9}, {
   3.653405637472932*^9, 3.653405641145392*^9}, {3.65575531821908*^9, 
   3.655755321163374*^9}, {3.655816226679068*^9, 3.655816253213999*^9}, {
   3.655816302499762*^9, 3.655816305797895*^9}, {3.65720028487078*^9, 
   3.65720032723665*^9}, 3.658230301263117*^9, {3.6650832420086613`*^9, 
   3.6650833114872828`*^9}, {3.665083776229237*^9, 3.665083780944594*^9}, {
   3.666532445932591*^9, 3.666532453602461*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Movie of the dynamics", "Section",
 CellChangeTimes->{{3.6379445240536833`*^9, 3.637944527085002*^9}}],

Cell["\<\
Make a movie out of the community\[CloseCurlyQuote]s dynamics along the trait \
axis.\
\>", "Text",
 CellChangeTimes->{{3.666532619265313*^9, 3.666532658738161*^9}}],

Cell[BoxData[
 RowBox[{"With", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"xlimit", "=", 
      RowBox[{"Min", "[", 
       RowBox[{"1", ",", 
        RowBox[{"Max", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"\[Mu]", "[", "i", "]"}], "[", "t", "]"}], "/.", 
                "sol"}], "/.", 
               RowBox[{"t", "\[Rule]", "tmax"}]}], ")"}], "+", 
             RowBox[{"3", "*", 
              RowBox[{"\[Sigma]", "[", "i", "]"}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "S"}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"\[Mu]", "[", "i", "]"}], "[", "t", "]"}], "/.", 
                "sol"}], "/.", 
               RowBox[{"t", "\[Rule]", "0"}]}], ")"}], "+", 
             RowBox[{"3", "*", 
              RowBox[{"\[Sigma]", "[", "i", "]"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "S"}], "}"}]}], "]"}], ",", 
          RowBox[{"Abs", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Mu]", "[", "i", "]"}], "[", "t", "]"}], "/.", 
                 "sol"}], "/.", 
                RowBox[{"t", "\[Rule]", "tmax"}]}], ")"}], "-", 
              RowBox[{"3", "*", 
               RowBox[{"\[Sigma]", "[", "i", "]"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "S"}], "}"}]}], "]"}], "]"}], ",", 
          RowBox[{"Abs", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Mu]", "[", "i", "]"}], "[", "t", "]"}], "/.", 
                 "sol"}], "/.", 
                RowBox[{"t", "\[Rule]", "0"}]}], ")"}], "-", 
              RowBox[{"3", "*", 
               RowBox[{"\[Sigma]", "[", "i", "]"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "S"}], "}"}]}], "]"}], "]"}], ",", 
          "0.6"}], "]"}]}], "]"}]}], ",", 
     RowBox[{"ylimit", "=", 
      RowBox[{"Max", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"n", "[", "i", "]"}], "[", "t", "]"}], "/.", "sol"}], "/.", 
            RowBox[{"t", "\[Rule]", "tmax"}]}], ")"}], "/", 
          RowBox[{"Min", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Sqrt", "[", 
              RowBox[{"2", "*", "Pi", "*", 
               RowBox[{
                RowBox[{"\[Sigma]", "[", "j", "]"}], "^", "2"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", "S"}], "}"}]}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "S"}], "}"}]}], "]"}], "]"}]}]}], "}"}],
    ",", "\[IndentingNewLine]", 
   RowBox[{"Animate", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Show", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"z", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"\[Mu]", "[", "i", "]"}], "[", "t", "]"}], "/.", 
                    "sol"}], ")"}]}], ")"}], "^", "2"}]}], "/", 
                 RowBox[{"(", 
                  RowBox[{"2", "*", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[Sigma]", "[", "i", "]"}], ")"}], "^", "2"}]}], 
                  ")"}]}], "]"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Sigma]", "[", "i", "]"}], "*", 
                 RowBox[{"Sqrt", "[", 
                  RowBox[{"2", "*", "Pi"}], "]"}]}], ")"}]}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"n", "[", "i", "]"}], "[", "t", "]"}], "/.", "sol"}],
                ")"}]}], "/.", 
             RowBox[{"t", "\[Rule]", "\[Tau]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "S"}], "}"}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"z", ",", 
           RowBox[{"-", "xlimit"}], ",", "xlimit"}], "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"1.02", "*", "ylimit"}]}], "}"}]}], "}"}]}], ",", 
         RowBox[{"Filling", "\[Rule]", "Axis"}], ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"Axes", "\[Rule]", "False"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<Trait value\>\"", ",", "\"\<Density\>\""}], "}"}]}], 
         ",", 
         RowBox[{"FrameStyle", "\[Rule]", 
          RowBox[{"Directive", "[", "14", "]"}]}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"z", ",", "\[Theta]"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"c", "*", "z"}]}], ")"}], "*", "ylimit"}], ",", 
         RowBox[{"{", 
          RowBox[{"z", ",", 
           RowBox[{"-", "xlimit"}], ",", "xlimit"}], "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
         RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Darker", "[", "Red", "]"}], ",", "Dashed", ",", 
            RowBox[{"Opacity", "[", "0.4", "]"}]}], "}"}]}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"\[Tau]", ",", "0", ",", "tmax"}], "}"}], ",", 
     RowBox[{"AnimationRunning", "\[Rule]", "False"}], ",", 
     RowBox[{"AppearanceElements", "\[Rule]", 
      RowBox[{"{", "\"\<ResetButton\>\"", "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.637493691756343*^9, 3.637493710554346*^9}, {
   3.637493800938452*^9, 3.63749380299218*^9}, 3.637493851158869*^9, {
   3.637493929384885*^9, 3.637493929830949*^9}, {3.637494282150515*^9, 
   3.637494322219735*^9}, {3.6374944434746*^9, 3.6374944830294313`*^9}, {
   3.6374945192456284`*^9, 3.637494531351737*^9}, {3.637494892366939*^9, 
   3.637494892615903*^9}, {3.637494963221972*^9, 3.637494963455636*^9}, {
   3.637597586770486*^9, 3.637597597913134*^9}, {3.63759768622366*^9, 
   3.637597687439995*^9}, {3.637599136554263*^9, 3.637599140082121*^9}, {
   3.637600812101986*^9, 3.63760081865545*^9}, 3.637601893614121*^9, {
   3.637602793723666*^9, 3.6376028026145697`*^9}, 3.6376029783566504`*^9, {
   3.637603015818262*^9, 3.637603098966414*^9}, {3.637603263726967*^9, 
   3.637603297178392*^9}, {3.637603394132636*^9, 3.63760339442854*^9}, {
   3.6376064409173737`*^9, 3.637606441085939*^9}, {3.637606810749658*^9, 
   3.637606814994072*^9}, {3.637607665086632*^9, 3.637607675298008*^9}, {
   3.637607733750037*^9, 3.6376077340515127`*^9}, {3.6379222288393393`*^9, 
   3.637922231106265*^9}, {3.6379242924667673`*^9, 3.637924292662771*^9}, {
   3.637924329234473*^9, 3.637924395150769*^9}, {3.637924427033822*^9, 
   3.637924440095191*^9}, {3.637924484162835*^9, 3.637924491745319*^9}, {
   3.637924781610579*^9, 3.6379247820850573`*^9}, 3.637924848549004*^9, {
   3.637926350611442*^9, 3.6379263527561083`*^9}, {3.637926516464369*^9, 
   3.637926524274688*^9}, {3.637926604290896*^9, 3.637926623258606*^9}, {
   3.637926662477984*^9, 3.6379266654673023`*^9}, {3.637926766357535*^9, 
   3.637926790284687*^9}, 3.6379290998498087`*^9, {3.637934325491837*^9, 
   3.6379343257798243`*^9}, {3.637934656245104*^9, 3.637934688529894*^9}, {
   3.637934733468094*^9, 3.637934792855577*^9}, {3.63794314293952*^9, 
   3.6379431467480288`*^9}, {3.637943876339982*^9, 3.63794388496122*^9}, {
   3.637959242943746*^9, 3.637959261602373*^9}, {3.638019259327915*^9, 
   3.6380192781625957`*^9}, {3.6380193479708548`*^9, 3.638019380502185*^9}, {
   3.638032192412393*^9, 3.638032230475617*^9}, {3.638032407476565*^9, 
   3.638032416159815*^9}, {3.638034262664547*^9, 3.638034276408052*^9}, {
   3.638056775484626*^9, 3.638056776777553*^9}, {3.638100112615044*^9, 
   3.6381001167198267`*^9}, {3.638100153115641*^9, 3.6381001855029917`*^9}, {
   3.6381002181679277`*^9, 3.6381002768466988`*^9}, {3.6381003185349283`*^9, 
   3.638100407815015*^9}, {3.638100456402442*^9, 3.6381004869185658`*^9}, {
   3.638100535074698*^9, 3.6381005417828493`*^9}, {3.638100573775255*^9, 
   3.638100590335869*^9}, {3.638100622674144*^9, 3.638100627464921*^9}, {
   3.63810071008353*^9, 3.6381007398783197`*^9}, {3.638100779550007*^9, 
   3.638100820166803*^9}, {3.638100874458807*^9, 3.6381009555364637`*^9}, {
   3.638101284151781*^9, 3.6381013130970573`*^9}, {3.638101350081387*^9, 
   3.6381013630544033`*^9}, {3.638101474628039*^9, 3.638101596316491*^9}, {
   3.638101657485488*^9, 3.638101720906693*^9}, {3.63810194027665*^9, 
   3.638101943214115*^9}, {3.638102100852693*^9, 3.6381021790889597`*^9}, {
   3.6381026610233107`*^9, 3.638102690284953*^9}, {3.63810272986234*^9, 
   3.6381028544543543`*^9}, {3.63810299569864*^9, 3.638103005863041*^9}, {
   3.638119729232995*^9, 3.638119736394825*^9}, {3.638287096842658*^9, 
   3.638287119977268*^9}, {3.638287334886178*^9, 3.6382873559432297`*^9}, {
   3.638366249435417*^9, 3.63836625852917*^9}, {3.638367161043841*^9, 
   3.638367212346394*^9}, {3.638367635912057*^9, 3.6383676478682756`*^9}, {
   3.638397836045658*^9, 3.638397860460228*^9}, {3.638397914596601*^9, 
   3.638397916273542*^9}, {3.638398032684848*^9, 3.6383980334708443`*^9}, {
   3.6383984734627247`*^9, 3.638398483395748*^9}, {3.6385348547106028`*^9, 
   3.638534855059091*^9}, {3.638534890145556*^9, 3.6385348948260317`*^9}, {
   3.6385349684037237`*^9, 3.638535002506029*^9}, {3.638618340596569*^9, 
   3.638618340753916*^9}, {3.638625621583078*^9, 3.6386256509275208`*^9}, {
   3.6390698067680597`*^9, 3.639069825913933*^9}, {3.639069867778575*^9, 
   3.639069912573596*^9}, {3.6390816925503693`*^9, 3.6390817120052958`*^9}, {
   3.643387271771253*^9, 3.6433873113831377`*^9}, {3.653243388012127*^9, 
   3.6532433882438917`*^9}, {3.6534056468568697`*^9, 
   3.6534056491282177`*^9}, {3.655816320119329*^9, 3.655816382977145*^9}, {
   3.657200337373637*^9, 3.657200357994338*^9}, {3.657201251199602*^9, 
   3.6572012756219273`*^9}, {3.658232099858109*^9, 3.658232124962392*^9}, {
   3.6582329668667507`*^9, 3.658232967008644*^9}, {3.664281094846739*^9, 
   3.664281124783564*^9}, {3.664553460872658*^9, 3.664553461220689*^9}, {
   3.665083503189019*^9, 3.665083511035699*^9}, {3.665083590004689*^9, 
   3.6650835924576597`*^9}, {3.6650837918723907`*^9, 3.665083795565731*^9}, {
   3.6652477841183033`*^9, 3.665247792910531*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{956, 1163},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"10.4 for Linux x86 (64-bit) (February 25, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 274, 5, 211, "Subchapter"],
Cell[857, 29, 944, 17, 38, "Input"],
Cell[CellGroupData[{
Cell[1826, 50, 101, 1, 81, "Section"],
Cell[1930, 53, 30309, 450, 364, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32276, 508, 214, 3, 81, "Section"],
Cell[32493, 513, 39196, 997, 2364, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71726, 1515, 98, 1, 81, "Section"],
Cell[71827, 1518, 4831, 76, 89, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76695, 1599, 97, 1, 81, "Section"],
Cell[76795, 1602, 354, 6, 88, "Text"],
Cell[77152, 1610, 13052, 330, 989, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[90241, 1945, 108, 1, 81, "Section"],
Cell[90352, 1948, 175, 4, 38, "Text"],
Cell[90530, 1954, 11769, 244, 689, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

